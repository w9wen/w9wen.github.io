I"ã<p>åœ¨Xamarin Formsè·¨å¹³å°å­˜å–Androidçš„Activityï¼Œéœ€è¦å®‰è£èˆ‡è¨­å®šCurrentActivityPluginæ‰èƒ½é”æˆï¼Œæ¯”å¦‚ä½¿ç”¨MediaPluginåœ¨Androidå°±éœ€è¦ç”¨åˆ°ï¼Œè«‹åƒè€ƒ<a href="https://montemagno.com/access-the-current-android-activity-from-anywhere/">Access the Current Android Activity from Anywhere</a>ï¼Œå®‰è£æ­¥é©Ÿè«‹åƒè€ƒ<a href="https://github.com/jamesmontemagno/CurrentActivityPlugin">Xamarin.Forms CurrentActivityPlugin</a></p>

<ol>
  <li>
    <p>å®‰è£CurrentActivity Plugin
åœ¨Xamarin.Androidå°ˆæ¡ˆä½¿ç”¨Manage Nuget Packagesæ‰¾åˆ°Plugin.CurrentActivityï¼Œç›®å‰ç‰ˆæœ¬æ˜¯v1.0.1ï¼Œæœ€å¾Œæ›´æ–°æ™‚é–“æ˜¯2015-12-19ï¼Œä½†å·²çœ‹åˆ°æœ‰betaç‰ˆé‡‹å‡ºï¼Œæ¯”è¼ƒæ”¾å¿ƒå‹‡æ•¢åœ°ä½¿ç”¨ğŸ˜¸
  <img src="/images/2018/04/install-currentactivity-01.png" alt="install-currentactivity-01" /></p>
  </li>
  <li>æ–°å¢ä¸€å€‹åç‚ºâ€MainApplication.csâ€çš„C# class
    <ul>
      <li>å®‰è£CurrentActivityå¾Œæœƒé–‹å•Ÿreadme.txtå…§å®¹æ•˜è¿°ä¸­ï¼Œèªªæ˜äº†Xamarin.Androidæ ¹ç›®éŒ„æœƒå®‰è£â€MainApplication.csâ€ï¼Œé€™æ¨£çš„æ•˜è¿°æˆ‘èªç‚ºæ‡‰è©²æ˜¯è‡ªå‹•ç”¢ç”Ÿï¼Œä½†çœ‹èµ·ä¾†ä¸¦æ²’æœ‰ï¼Œå°±è‡ªå·±å»ºç«‹å§ã€‚</li>
      <li>åœ¨classåŠ è¨»[Application]ã€‚</li>
      <li>â€œMainApplicationâ€ç¹¼æ‰¿Application, ä»¥åŠApplicaion.IActivityLifecycleCallbacksã€‚</li>
      <li>ç”¨å·¥å…·Implement IActivityLifecycleCallbacksçš„Interface(åœ¨IActivityLifecycleCallbacksçš„Interfaceä¸Šé»é¸å³å¯)ã€‚</li>
      <li>å¢åŠ ä¸€å€‹constructorã€‚</li>
      <li>override OnCreateä»¥åŠOnTerminateï¼Œåˆ†åˆ¥åŠ å…¥RegisterActivityLifecycleCallbacks(this)ä»¥åŠUnregisterActivityLifecycleCallbacks(this)</li>
      <li>åœ¨OnActivityCreated, OnActivityStarted, OnActivityResumedåŠ å…¥CrossCurrentActivity.Current.Activity = activityã€‚</li>
    </ul>
  </li>
  <li>å®Œæ•´ç¨‹å¼ç¢¼å¦‚ä¸‹
    <div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="p">[</span><span class="n">Application</span><span class="p">]</span>
  <span class="k">public</span> <span class="k">class</span> <span class="nc">MainApplication</span> <span class="p">:</span> <span class="n">Application</span><span class="p">,</span> <span class="n">Application</span><span class="p">.</span><span class="n">IActivityLifecycleCallbacks</span>
  <span class="p">{</span>
      <span class="k">protected</span> <span class="nf">MainApplication</span><span class="p">(</span><span class="n">IntPtr</span> <span class="n">javaReference</span><span class="p">,</span> <span class="n">JniHandleOwnership</span> <span class="n">transfer</span><span class="p">)</span> <span class="p">:</span> <span class="k">base</span><span class="p">(</span><span class="n">javaReference</span><span class="p">,</span> <span class="n">transfer</span><span class="p">)</span>
      <span class="p">{</span>
      <span class="p">}</span>

      <span class="k">public</span> <span class="k">override</span> <span class="k">void</span> <span class="nf">OnCreate</span><span class="p">()</span>
      <span class="p">{</span>
          <span class="k">base</span><span class="p">.</span><span class="nf">OnCreate</span><span class="p">();</span>
          <span class="nf">RegisterActivityLifecycleCallbacks</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
      <span class="p">}</span>

      <span class="k">public</span> <span class="k">override</span> <span class="k">void</span> <span class="nf">OnTerminate</span><span class="p">()</span>
      <span class="p">{</span>
          <span class="k">base</span><span class="p">.</span><span class="nf">OnTerminate</span><span class="p">();</span>
          <span class="nf">UnregisterActivityLifecycleCallbacks</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
      <span class="p">}</span>

      <span class="k">public</span> <span class="k">void</span> <span class="nf">OnActivityCreated</span><span class="p">(</span><span class="n">Activity</span> <span class="n">activity</span><span class="p">,</span> <span class="n">Bundle</span> <span class="n">savedInstanceState</span><span class="p">)</span>
      <span class="p">{</span>
          <span class="n">CrossCurrentActivity</span><span class="p">.</span><span class="n">Current</span><span class="p">.</span><span class="n">Activity</span> <span class="p">=</span> <span class="n">activity</span><span class="p">;</span>
      <span class="p">}</span>

      <span class="k">public</span> <span class="k">void</span> <span class="nf">OnActivityResumed</span><span class="p">(</span><span class="n">Activity</span> <span class="n">activity</span><span class="p">)</span>
      <span class="p">{</span>
          <span class="n">CrossCurrentActivity</span><span class="p">.</span><span class="n">Current</span><span class="p">.</span><span class="n">Activity</span> <span class="p">=</span> <span class="n">activity</span><span class="p">;</span>
      <span class="p">}</span>

      <span class="k">public</span> <span class="k">void</span> <span class="nf">OnActivityStarted</span><span class="p">(</span><span class="n">Activity</span> <span class="n">activity</span><span class="p">)</span>
      <span class="p">{</span>
          <span class="n">CrossCurrentActivity</span><span class="p">.</span><span class="n">Current</span><span class="p">.</span><span class="n">Activity</span> <span class="p">=</span> <span class="n">activity</span><span class="p">;</span>
      <span class="p">}</span>
  <span class="p">}</span>
</code></pre></div>    </div>
  </li>
</ol>

<p>åˆ°é€™é‚Šå®‰è£è¨­å®šå®Œæˆï¼Œåœ¨è·¨å°ˆæ¡ˆå­˜å–Activityã€‚</p>
:ET